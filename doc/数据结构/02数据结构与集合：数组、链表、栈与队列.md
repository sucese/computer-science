# æ•°æ®ç»“æ„ä¸é›†åˆï¼šæ•°ç»„ã€é“¾è¡¨ã€æ ˆä¸é˜Ÿåˆ—

**å…³äºä½œè€…**

>éƒ­å­æ˜Ÿï¼Œç¨‹åºå‘˜ï¼Œå‰ä»–æ‰‹ï¼Œä¸»è¦ä»äº‹Androidå¹³å°åŸºç¡€æ¶æ„æ–¹é¢çš„å·¥ä½œï¼Œæ¬¢è¿äº¤æµæŠ€æœ¯æ–¹é¢çš„é—®é¢˜ï¼Œå¯ä»¥å»æˆ‘çš„[Github](https://github.com/guoxiaoxing)æissueæˆ–è€…å‘é‚®ä»¶è‡³guoxiaoxingse@163.comä¸æˆ‘äº¤æµã€‚

**æ–‡ç« ç›®å½•**

- ä¸€ ArrayListå®ç°åŸç†
- äºŒ LinkedListå®ç°åŸç†

æ›´å¤šæ–‡ç« è¯·å‚è§ï¼š[Data Structure And Algorithm](https://github.com/guoxiaoxing/data-structure-and-algorithm/blob/master/README.md)

æ•°ç»„ã€é“¾è¡¨ã€æ ˆä¸é˜Ÿåˆ—ä½¿æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­æœ€ä¸ºå¸¸ç”¨çš„å››ç§æ•°æ®ç»“æ„ï¼Œä¹‹æ‰€ä»¥å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·è®¨è®ºï¼Œæ˜¯å› ä¸ºå®ƒä»¬éƒ½æ˜¯è¡¨çš„ä¸€ç§ï¼Œæœ‰å¾ˆå¤šç›¸ä¼¼çš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹å®ƒä»¬
çš„å®šä¹‰ã€‚

ä»€ä¹ˆæ˜¯è¡¨ï¼ŸğŸ¤”

>æˆ‘ä»¬å°†å½¢å¦‚A1ï¼ŒA2ï¼ŒA3ï¼ŒA4 ... ANç§°ä¹‹ä¸ºä¸€ä¸ªè¡¨ï¼Œå¤§å°ä¸º0çš„è¡¨æˆ‘ä»¬ç§°ä¹‹ä¸ºç©ºè¡¨ã€‚

å¸¸ç”¨çš„è¡¨å¦‚ä¸‹æ‰€ç¤ºï¼š

- æ•°ç»„
- å•å‘é“¾è¡¨/åŒå‘é“¾è¡¨
- æ ˆ
- é˜Ÿåˆ—/åŒç«¯é˜Ÿåˆ—

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/list/List_structure.png"/>

**æ•°ç»„**

>æ•°ç»„æ˜¯æœ€ä¸ºç®€å•çš„ä¸€ç§è¡¨ï¼Œå®ƒåœ¨æŸ¥æ‰¾æ“ä½œæ˜¯çº¿æ€§æ—¶é—´çš„ï¼Œä½†æ˜¯æ’å…¥ä¸åˆ é™¤åˆ™æ½œè—é¢å¤–çš„å¼€é”€ã€‚

- å¦‚æœæ’å…¥çš„ä½ç½®åœ¨ç¬¬ä¸€ä¸ªï¼Œåˆ™éœ€è¦å°†åé¢çš„å…ƒç´ å…¨éƒ¨å‘åç§»åŠ¨ä¸€ä½ï¼Œæ—¶é—´å¤æ‚å‰¯ä¸ºO(N)
- å¦‚æœæ’å…¥çš„ä½ç½®åœ¨æœ€åä¸€ä¸ªï¼Œåˆ™æ— éœ€ç§»åŠ¨å…¶ä»–å…ƒç´ ï¼Œæ—¶é—´å¤æ‚å‰¯ä¸ºO(1)

æ€»ç»“èµ·æ¥ï¼Œæ’å…¥/åˆ é™¤çš„æ—¶é—´æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚

**é“¾è¡¨**

>é“¾è¡¨ç”±ä¸€ç³»åˆ—èŠ‚ç‚¹ç»„æˆï¼Œè¿™äº›èŠ‚ç‚¹ä¸å¿…åœ¨å†…å­˜ä¸­ç›¸è¿ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‡å«æœ‰è¡¨å…ƒç´ å’Œåˆ°åŒ…å«è¯¥å…ƒç´ åç»§å…ƒçš„èŠ‚ç‚¹çš„é“¾ï¼Œç§°ä¸ºnexté“¾ã€‚è¿™æ ·çš„é“¾è¡¨
ç§°ä¸ºå•é“¾è¡¨ï¼Œå¦å¤–ï¼Œå¦‚æœèŠ‚ç‚¹è¿˜åŒ…å«æŒ‡å‘å®ƒåœ¨é“¾è¡¨ä¸­çš„å‰é©±èŠ‚ç‚¹çš„é“¾ï¼Œåˆ™æˆè¯¥é“¾è¡¨ä¸ºåŒé“¾è¡¨ã€‚

é“¾è¡¨æ˜¯ä¸ºäº†é¿å…æ’å…¥/åˆ é™¤å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œæˆ‘ä»¬åˆå¼•å…¥äº†é“¾è¡¨ï¼Œå…¶ä¸­ï¼Œé“¾è¡¨åˆå¯ä»¥åˆ†ä¸ºå•é“¾è¡¨ä¸åŒé“¾è¡¨ã€‚

**æ ˆ**

>æ ˆæ˜¯é™åˆ¶æ’å…¥å’Œåˆ é™¤åªèƒ½åœ¨è¡¨çš„æœ«ç«¯è¿›è¡Œçš„è¡¨ï¼Œä¹Ÿå°±æ˜¯å‡ºæ ˆä¸å…¥æ ˆæ“ä½œã€‚

**é˜Ÿåˆ—**

>é˜Ÿåˆ—ä¹Ÿæ˜¯ä¸€ç§è¡¨ï¼Œä½¿ç”¨é˜Ÿåˆ—æ—¶åœ¨ä¸€ç«¯è¿›è¡Œæ’å…¥è€Œåœ¨å¦ä¸€ç«¯è¿›è¡Œåˆ é™¤ã€‚

å¦‚åŒæ ˆä¸€æ ·ï¼Œå¯¹äºé˜Ÿåˆ—è€Œè¨€ä»»ä½•è¡¨çš„å®ç°éƒ½æ˜¯åˆæ³•çš„ã€‚

è¯´å®Œäº†å…³äºè¡¨çš„åŸºæœ¬æ¦‚å¿µï¼Œæˆ‘ä»¬æ¥èŠä¸€èŠJavaä¸­å¯¹è¡¨çš„åŸºæœ¬å®ç°ã€‚Javaä¸­ç”¨æ¥å£Listæ¥å®šä¹‰è¡¨çš„åŸºæœ¬åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¢ã€åˆ ã€æ”¹ã€æŸ¥ç­‰åŸºæœ¬æ“ä½œã€‚

Listæ¥å£å®šä¹‰å¦‚ä¸‹ï¼š

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/list/ArrayList_class.png"/>

æ³¨ï¼šé“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—éƒ½æ˜¯è¡¨ï¼Œå› æ­¤å¯¹äºå®ç°äº†è¡¨æ–¹æ³•çš„ArrayList/LinkedListéƒ½æ”¯æŒè€…ä¸‰ç§æ•°æ®ç»“æ„ã€‚

```java
public interface List<E> extends Collection<E> {
    // Query Operations
    int size();
    boolean isEmpty();
    boolean contains(Object o);
    Iterator<E> iterator();
    Object[] toArray();
    <T> T[] toArray(T[] a);

    // Modification Operations
    boolean add(E e);
    boolean remove(Object o);

    // Bulk Modification Operations
    boolean containsAll(Collection<?> c);
    boolean addAll(Collection<? extends E> c);
    boolean addAll(int index, Collection<? extends E> c);
    boolean removeAll(Collection<?> c);
    boolean retainAll(Collection<?> c);
    void clear();


    // Comparison and hashing
    boolean equals(Object o);
    int hashCode();


    // Positional Access Operations
    E get(int index);
    E set(int index, E element);
    void add(int index, E element);
    E remove(int index);


    // Search Operations
    int indexOf(Object o);
    int lastIndexOf(Object o);


    // List Iterators
    ListIterator<E> listIterator();
    ListIterator<E> listIterator(int index);

    // View
    List<E> subList(int fromIndex, int toIndex);
    
    @Override
    default Spliterator<E> spliterator() {
        return Spliterators.spliterator(this, Spliterator.ORDERED);
    }
    
    default void replaceAll(UnaryOperator<E> operator) {
        Objects.requireNonNull(operator);
        final ListIterator<E> li = this.listIterator();
        while (li.hasNext()) {
            li.set(operator.apply(li.next()));
        }
    }
    default void sort(Comparator<? super E> c) {
        Collections.sort(this, c);
    }
}

```
å…³äºListæ¥å£ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå¸¸ç”¨çš„å®ç°ç±»ã€‚

- ArrayListï¼šæä¾›äº†ä¸€ç§List ADTçš„å¯å¢é•¿çš„å®ç°ï¼Œä¼˜ç‚¹åœ¨äºgetã€setèŠ±è´¹å¸¸é‡æ—¶é—´ï¼Œç¼ºç‚¹åœ¨äºæ’å…¥ã€åˆ é™¤ä»£ä»·æ˜‚è´µã€‚
- LinkedListï¼šæä¾›äº†ä¸€ç§List ADTçš„åŒé“¾è¡¨çš„å®ç°ã€‚ä¼˜ç‚¹åœ¨äºæ’å…¥ã€åˆ é™¤æ“ä½œå¼€é”€è¾ƒå°ï¼Œç¼ºç‚¹åœ¨äºä¸ç”¨äºåšç´¢å¼•ï¼Œgetæ“ä½œä»£ä»·æ˜‚è´µã€‚

## ä¸€ ArrayListå®ç°åŸç†

> ArrayListæä¾›äº†ä¸€ç§List ADTçš„å¯å¢é•¿çš„å®ç°ï¼Œä¼˜ç‚¹åœ¨äºgetã€setèŠ±è´¹å¸¸é‡æ—¶é—´ï¼Œç¼ºç‚¹åœ¨äºæ’å…¥ã€åˆ é™¤ä»£ä»·æ˜‚è´µã€‚

ArrayListæ˜¯ä»¥æ•°ç»„ä¸ºåŸºç¡€å®ç°çš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…·ä½“è¯´æ¥ï¼Œå®ƒæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- å¿«é€ŸæŸ¥æ‰¾ï¼Œåœ¨ç‰©ç†å†…å­˜ä¸Šé‡‡ç”¨é¡ºåºå­˜å‚¨ç»“æ„ï¼Œå¯ä»¥æ ¹æ®ç´¢å¼•è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾ã€‚
- å®¹é‡åŠ¨æ€å¢é•¿ï¼šå½“æ•°ç»„å®¹é‡ä¸å¤Ÿç”¨æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªæ¯”åŸæ¥æ›´å¤§çš„æ•°ç»„ï¼Œå°†åŸæ¥æ•°ç»„çš„å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚
- å¯ä»¥æ’å…¥null
- æ²¡æœ‰åšåŒæ­¥ï¼Œéçº¿ç¨‹å®‰å…¨

ArrayListç±»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/list/LinkedList_class.png"/>

å®ç°äº†ä»¥ä¸‹æ¥å£ï¼š

- Listï¼šList ADTç›¸å…³æ–¹æ³•ã€‚
- RandomAccessï¼šéšæœºè®¿é—®åŠŸèƒ½ï¼Œåœ¨ArrayListä¸­é€šè¿‡ç´¢å¼•å¿«é€Ÿè·å–å…ƒç´ ï¼Œè¿™å°±æ˜¯éšæœºè®¿é—®åŠŸèƒ½ã€‚
- Cloneableï¼šè¿”å›ArrayListçš„æµ…æ‹·è´ã€‚
- Serialiableï¼šå®ç°äº†åºåˆ—åŒ–åŠŸèƒ½ã€‚

ArrayListé‡‡ç”¨æ•°ç»„å­˜å–å…ƒç´ ã€‚

```java
//ä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„ï¼Œå®ƒé‡‡ç”¨transientå…³é”®å­—æ ‡è®°ï¼Œè¯´æ˜åºåˆ—åŒ–ArrayListå¿½ç•¥æ‰è¯¥å­—æ®µ
transient Object[] elementData;

//æ•°æ®æ•°é‡
private int size;
```

æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹ArrayListå…³äºå¢ã€åˆ ã€æ”¹ã€æŸ¥çš„å®ç°ã€‚

#### add

æ—¶é—´å¤æ‚åº¦ï¼šO(N)

å®ç°åŸç†ï¼šArrayListå¯ä»¥åœ¨æŒ‡å®šä½ç½®å¢åŠ å…ƒç´ ï¼Œå¢åŠ å…ƒç´ åï¼Œå½“å‰å…ƒç´ åé¢çš„å…ƒç´ éƒ½è¦å‘åç§»åŠ¨ä¸€ä½ã€‚

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{
    
    public boolean add(E e) {
        ensureCapacityInternal(size + 1);  // Increments modCount!!
        elementData[size++] = e;
        return true;
    }

    public void add(int index, E element) {
        if (index > size || index < 0)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));

        ensureCapacityInternal(size + 1);  // Increments modCount!!
        
        //å°†æ•°ç»„elementDataä»indexä½ç½®å¼€å§‹çš„æ‰€æœ‰å…ƒç´ ï¼Œæ‹·è´åˆ°elementDataä»index + 1ä½ç½®å¼€å§‹çš„ä½ç½®
        //ä¹Ÿå°±æ˜¯indexä½ç½®åé¢çš„å…ƒç´ å…¨éƒ¨å‘åç§»åŠ¨ä¸€ä½
        System.arraycopy(elementData, index, elementData, index + 1,
                         size - index);
        elementData[index] = element;
        size++;
    }   
}
```

ArrayListä¼šè°ƒç”¨ensureCapacityInternal()æ–¹æ³•æ¥ä¿è¯æ•°ç»„å®¹é‡çš„è‡ªåŠ¨å¢é•¿ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®ƒçš„å®ç°ã€‚

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{
   private void ensureExplicitCapacity(int minCapacity) {
           modCount++;
   
           // overflow-conscious code
           if (minCapacity - elementData.length > 0)
               grow(minCapacity);
       }
       
       //ArrayListå†…éƒ¨æ•°ç»„çš„æœ€å¤§å®¹é‡
       private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;
   
       private void grow(int minCapacity) {
           // overflow-conscious code
           int oldCapacity = elementData.length;
           int newCapacity = oldCapacity + (oldCapacity >> 1);// å³ç§»ä¸€ä½ï¼šx2
           if (newCapacity - minCapacity < 0)
               newCapacity = minCapacity;
           if (newCapacity - MAX_ARRAY_SIZE > 0)
               newCapacity = hugeCapacity(minCapacity);
           // å°†åŸæ¥æ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°é•¿åº¦çš„æ•°ç»„é‡Œ
           elementData = Arrays.copyOf(elementData, newCapacity);
       } 
}
```

å¯ä»¥çœ‹åˆ°ArrayListè°ƒç”¨grow(int minCapacity)æ–¹æ³•æ¥å¢åŠ å®¹é‡ï¼Œè¿™é‡Œæœ‰ä¸ªæœ€å°å®¹é‡minCapacityï¼Œå®ƒç­‰äºå½“å‰æ•°ç»„å¤§å°size+1ã€‚è¯¥æ–¹æ³•çš„
è®¡ç®—æµç¨‹å¦‚ä¸‹ï¼š

1. æ—§çš„å®¹é‡ = è¿‡å»æ•°ç»„çš„å¤§å°
2. æ–°çš„å®¹é‡ = è¿‡å»å®¹é‡ + è¿‡å»å®¹é‡x2
3. ä¸Šä¸€æ­¥è®¡ç®—çš„æ–°å®¹é‡å¦‚æœå°äºæœ€å°å®¹é‡åˆ™ä½¿ç”¨æœ€å°å®¹é‡ä½œä¸ºæ–°çš„å®¹é‡
4. å¦‚æœä¸Šä¸€æ­¥å¾—åˆ°çš„å®¹é‡å¤§äºæœ€å¤§æ•°ç»„å®¹é‡ï¼Œåˆ™ä½¿ç”¨æœ€å¤§æ•°ç»„å®¹é‡ä½œä¸ºæ–°çš„å®¹é‡
5. å°†åŸæœ‰æ•°ç»„çš„æ•°æ®æ‹·è´åˆ°æ–°æ•°ç»„ï¼Œå¹¶èµ‹å€¼ç»™elementDataã€‚

è¿™é‡Œæˆ‘ä»¬è¿˜è¦æåˆ°ä¸€ä¸ªæ•°ç»„æ‹·è´çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ä¸ªnativeæ–¹æ³•ã€‚

```java
public static native void arraycopy(Object src,  int  srcPos,
                                    Object dest, int destPos,
                                    int length);
```
- Object srcï¼šæºæ•°ç»„
- int  srcPosï¼šåŸæ•°ç»„å¼€å§‹æ‹·è´çš„ä½ç½®
- Object destï¼šç›®æ ‡æ•°ç»„
- int destPosï¼šç›®æ ‡æ•°ç»„å¼€å§‹æ‹·è´çš„ä½ç½®
- int lengthï¼šè¢«æ‹·è´å…ƒç´ çš„æ•°é‡

#### remove

æ—¶é—´å¤æ‚åº¦ï¼šO(N)

å®ç°åŸç†ï¼šåˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œåˆ é™¤å…ƒç´ åï¼ŒæŠŠè¯¥å…ƒç´ åé¢çš„æ‰€æœ‰å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä½

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{

    public E remove(int index) {
        if (index >= size)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));

        modCount++;
        E oldValue = (E) elementData[index];

        int numMoved = size - index - 1;
        if (numMoved > 0)
            //å½“å‰åˆ é™¤indexåé¢çš„å…ƒç´ å…¨éƒ¨å‘å‰ç§»åŠ¨ä¸€ä½
            System.arraycopy(elementData, index+1, elementData, index,
                             numMoved);
        elementData[--size] = null; // clear to let GC do its work

        return oldValue;
    }

    public boolean remove(Object o) {
        if (o == null) {
            for (int index = 0; index < size; index++)
                if (elementData[index] == null) {
                    fastRemove(index);
                    return true;
                }
        } else {
            for (int index = 0; index < size; index++)
                if (o.equals(elementData[index])) {
                    fastRemove(index);
                    return true;
                }
        }
        return false;
    }
}
```
ArrayListæä¾›äº†ä¸¤ç§ç§»é™¤å…ƒç´ çš„æ–¹æ³•ï¼ŒæŒ‰ç´¢å¼•ç§»é™¤ä¸æŒ‰å¯¹è±¡ç§»é™¤ï¼ŒæŒ‰å¯¹è±¡ç§»é™¤ä¼šå…ˆå»éå†è¯¥å¯¹è±¡çš„ç´¢å¼•ï¼Œç„¶åå†æŒ‰ç´¢å¼•ç§»é™¤ã€‚

#### set

æ—¶é—´å¤æ‚åº¦ï¼šO(1)

å®ç°åŸç†ï¼šæ›¿æ¢å†…éƒ¨æ•°ç»„ç›¸åº”ä½ç½®ä¸Šçš„å…ƒç´ 

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{
    public E set(int index, E element) {
        if (index >= size)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));

        E oldValue = (E) elementData[index];
        // æ›¿æ¢æŒ‡å®šindexçš„å…ƒç´ 
        elementData[index] = element;
        return oldValue;
    }
}
```
#### get

æ—¶é—´å¤æ‚åº¦ï¼šO(1)

å®ç°åŸç†ï¼šæ ¹æ®æŒ‡å®šç´¢å¼•è·å–å½“å‰å…ƒç´ ï¼Œæ— éœ€é¢å¤–çš„è®¡ç®—ã€‚

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{
    
   public E get(int index) {
       if (index >= size)
           throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
       // ä»æŒ‡å®šindexè·å–å…ƒç´ 
       return (E) elementData[index];
   }
}
```

## äºŒ LinkedListå®ç°åŸç†

>LinkedListæä¾›äº†ä¸€ç§List ADTçš„åŒé“¾è¡¨çš„å®ç°ã€‚ä¼˜ç‚¹åœ¨äºæ’å…¥ã€åˆ é™¤æ“ä½œå¼€é”€è¾ƒå°ï¼Œç¼ºç‚¹åœ¨äºä¸ç”¨äºåšç´¢å¼•ï¼Œgetæ“ä½œä»£ä»·æ˜‚è´µã€‚

LinkedListåŸºäºåŒå‘é“¾è¡¨å®ç°çš„ï¼Œå®ƒå…·æœ‰ä»¥ç‰¹ç‚¹ï¼š

- åŸºäºåŒå‘é“¾è¡¨å®ç°ï¼Œå¯ä»¥ä½œä¸ºé“¾è¡¨ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ ˆã€é˜Ÿåˆ—å’ŒåŒç«¯é˜Ÿåˆ—ä½¿ç”¨ã€‚
- æ²¡æœ‰åšåŒæ­¥ï¼Œéçº¿ç¨‹å®‰å…¨

ArrayListç±»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

å®ç°äº†ä»¥ä¸‹æ¥å£ï¼š

- Listï¼šList ADTç›¸å…³æ–¹æ³•ã€‚
- Dequeï¼šå¯ä»¥å°†LinkedListå½“åšåŒç«¯é˜Ÿåˆ—æ¥ä½¿ç”¨ã€‚
- Cloneableï¼šè¿”å›ArrayListçš„æµ…æ‹·è´ã€‚
- Serialiableï¼šå®ç°äº†åºåˆ—åŒ–åŠŸèƒ½ã€‚

LinkedListé‡Œç”¨èŠ‚ç‚¹æ¥æè¿°é‡Œé¢çš„æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
private static class Node<E> {
    E item;
    Node<E> next;
    Node<E> prev;

    Node(Node<E> prev, E element, Node<E> next) {
        this.item = element;
        this.next = next;
        this.prev = prev;
    }
}
```
å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«äº†å½“å‰çš„å…ƒç´ ä»¥åŠå®ƒçš„å‰é©±èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹ã€‚

LinkedListåŒ…å«äº†ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼š

```java
//èŠ‚ç‚¹ä¸ªæ•°
transient int size = 0;

//ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
transient Node<E> first;

//æœ€åä¸€ä¸ªèŠ‚ç‚¹
transient Node<E> last;
```

æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹ArrayListå…³äºå¢ã€åˆ ã€æ”¹ã€æŸ¥çš„å®ç°ã€‚

#### add

æ—¶é—´å¤æ‚åº¦ï¼šadd(E e) - O(1)ï¼Œadd(int index, E element) - O(N)

å®ç°åŸç†ï¼šå¢åŠ å’Œåˆ é™¤çš„è¿‡ç¨‹éƒ½æ˜¯ä¸€ä¸ªé’ˆå¯¹æŒ‡å®šèŠ‚ç‚¹è¿›è¡Œå‰é©±å’Œåç»§å…³ç³»ä¿®æ”¹çš„è¿‡ç¨‹ï¼Œå¦‚æœæ˜¯åœ¨èµ·å§‹èŠ‚ç‚¹å’Œæœ«å°¾èŠ‚ç‚¹æ’å…¥ã€æ•´ä¸ªè¿‡ç¨‹æ— éœ€é¢å¤–çš„éå†è®¡ç®—ã€‚
å¦‚æœå®åœ¨ä¸­é—´ä½ç½®æ’å…¥ï¼Œåˆ™éœ€è¦æŸ¥æ‰¾å½“å‰ç´¢å¼•çš„èŠ‚ç‚¹ã€‚

åŸç†å›¾å¦‚ä¸‹ï¼š

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/list/List_ADT.png"/>

```java
public class LinkedList<E>
    extends AbstractSequentialList<E>
    implements List<E>, Deque<E>, Cloneable, java.io.Serializable{
    
    public boolean add(E e) {
            linkLast(e);
            return true;
        }
        
    public void add(int index, E element) {
        checkPositionIndex(index);

        if (index == size)
            linkLast(element);
        else
            linkBefore(element, node(index));
    }
    
    //æŸ¥æ‰¾æŒ‡å®šç´¢å¼•çš„èŠ‚ç‚¹
    Node<E> node(int index) {
        //æ ¹æ®indexçš„å¤§å°å†³å®šæ˜¯ä»èµ·å§‹èŠ‚ç‚¹ï¼Œè¿˜æ˜¯ä»æœ«å°¾èŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾
        if (index < (size >> 1)) {
            Node<E> x = first;
            for (int i = 0; i < index; i++)
                x = x.next;
            return x;
        } else {
            Node<E> x = last;
            for (int i = size - 1; i > index; i--)
                x = x.prev;
            return x;
        }
    }
    
    private void linkFirst(E e) {
        final Node<E> f = first;
        //åˆ›å»ºä¸€ä¸ªä»¥èµ·å§‹èŠ‚ç‚¹lastä¸ºåç»§çš„èŠ‚ç‚¹
        final Node<E> newNode = new Node<>(null, e, f);
        //å°†æ–°åˆ›å»ºçš„èŠ‚ç‚¹é‡æ–°è®¾ç½®ä¸ºèµ·å§‹èŠ‚ç‚¹
        first = newNode;
        //å¦‚æœèµ·å§‹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™å°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºæœ«å°¾ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å°†èµ·å§‹èŠ‚ç‚¹çš„å‰é©±æŒ‡å‘æ–°åˆ›å»ºçš„èŠ‚ç‚¹
        if (f == null)
            last = newNode;
        else
            f.prev = newNode;
        //å¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1
        size++;
        modCount++;
    }

    //æœ«å°¾æ’å…¥å…ƒç´ 
    void linkLast(E e) {
        final Node<E> l = last;
        //åˆ›å»ºä¸€ä¸ªä»¥æœ«å°¾èŠ‚ç‚¹lastä¸ºå‰é©±çš„èŠ‚ç‚¹
        final Node<E> newNode = new Node<>(l, e, null);
        //å°†æ–°åˆ›å»ºçš„èŠ‚ç‚¹é‡æ–°è®¾ç½®ä¸ºæœ«å°¾èŠ‚ç‚¹
        last = newNode;
        //å¦‚æœæœ«å°¾èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™å°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºèµ·å§‹èŠ‚ç‚¹ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å°†æœ«å°¾èŠ‚ç‚¹çš„åç»§æŒ‡å‘æ–°åˆ›å»ºçš„èŠ‚ç‚¹
        if (l == null)
            first = newNode;
        else
            l.next = newNode;
        //å¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1
        size++;
        modCount++;
    }

    void linkBefore(E e, Node<E> succ) {
        final Node<E> pred = succ.prev;
        //ä»¥åŸæ¥èŠ‚ç‚¹çš„å‰é©±ä½œä¸ºè‡ªå·±çš„å‰é©±ï¼Œä»¥åŸæ¥èŠ‚ç‚¹ä½œä¸ºè‡ªå·±çš„åç»§ï¼Œåˆ›å»ºæ–°çš„èŠ‚ç‚¹
        final Node<E> newNode = new Node<>(pred, e, succ);
        //å°†æ–°çš„èŠ‚ç‚¹ä½œä¸ºåŸæ¥èŠ‚ç‚¹çš„å‰é©±
        succ.prev = newNode;
        //å¦‚æœåŸæ¥èŠ‚ç‚¹çš„å‰é©±ä¸ºç©ºï¼Œå³å®ƒåŸæ¥æ˜¯èµ·å§‹èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥å°†æ–°åˆ›å»ºçš„èŠ‚ç‚¹ä½œä¸ºæ–°çš„èµ·å§‹èŠ‚ç‚¹ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å°†
        //åŸæ¥èŠ‚ç‚¹çš„å‰é©±çš„åç»§è®¾ç½®ä¸ºå½“å‰åˆ›å»ºçš„æ–°èŠ‚ç‚¹
        if (pred == null)
            first = newNode;
        else
            pred.next = newNode;
        //å¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1
        size++;
        modCount++;
    }
}
```

æˆ‘ä»¬å¯ä»¥åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šä½ç½®ï¼Œé»˜è®¤åœ¨é“¾è¡¨æœ«å°¾æ’å…¥å…ƒç´ ã€‚å¯ä»¥çœ‹åˆ°addæ–¹æ³•çš„å®ç°æ˜¯ä¾èµ–äºlinkæ–¹æ³•æ¥å»ºç«‹å‰é©±ä¸åç»§çš„è”ç³»ã€‚

å…·ä½“è¯´æ¥ï¼š

linkFirst

1. åˆ›å»ºä¸€ä¸ªä»¥èµ·å§‹èŠ‚ç‚¹lastä¸ºåç»§çš„èŠ‚ç‚¹
2. å°†æ–°åˆ›å»ºçš„èŠ‚ç‚¹é‡æ–°è®¾ç½®ä¸ºèµ·å§‹èŠ‚ç‚¹
3. å¦‚æœèµ·å§‹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™å°†æ–°èŠ‚ç‚¹è®¾ç½®ä¸ºæœ«å°¾ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å°†èµ·å§‹èŠ‚ç‚¹çš„å‰é©±æŒ‡å‘æ–°åˆ›å»ºçš„èŠ‚ç‚¹
4. å¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1

linkBefore

1. ä»¥åŸæ¥èŠ‚ç‚¹çš„å‰é©±ä½œä¸ºè‡ªå·±çš„å‰é©±ï¼Œä»¥åŸæ¥èŠ‚ç‚¹ä½œä¸ºè‡ªå·±çš„åç»§ï¼Œåˆ›å»ºæ–°çš„èŠ‚ç‚¹
2. å°†æ–°çš„èŠ‚ç‚¹ä½œä¸ºåŸæ¥èŠ‚ç‚¹çš„å‰é©±
3. å¦‚æœåŸæ¥èŠ‚ç‚¹çš„å‰é©±ä¸ºç©ºï¼Œå³å®ƒåŸæ¥æ˜¯èµ·å§‹èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥å°†æ–°åˆ›å»ºçš„èŠ‚ç‚¹ä½œä¸ºæ–°çš„èµ·å§‹èŠ‚ç‚¹ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å°†åŸæ¥èŠ‚ç‚¹çš„å‰é©±çš„åç»§è®¾ç½®ä¸ºå½“å‰åˆ›å»ºçš„æ–°èŠ‚ç‚¹
4. å¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1

#### remove

æ—¶é—´å¤æ‚åº¦ï¼šO(1)

å®ç°åŸç†ï¼šå¢åŠ å’Œåˆ é™¤çš„è¿‡ç¨‹éƒ½æ˜¯ä¸€ä¸ªé’ˆå¯¹æŒ‡å®šèŠ‚ç‚¹è¿›è¡Œå‰é©±å’Œåç»§å…³ç³»ä¿®æ”¹çš„è¿‡ç¨‹ï¼Œæ•´ä¸ªè¿‡ç¨‹æ— éœ€é¢å¤–çš„éå†è®¡ç®—ã€‚

åŸç†å›¾å¦‚ä¸‹ï¼š

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/list/List_ADT.png"/>

```java
public class LinkedList<E>
    extends AbstractSequentialList<E>
    implements List<E>, Deque<E>, Cloneable, java.io.Serializable{
    
   public E remove() {
        return removeFirst();
    }
    
    public E remove(int index) {
        checkElementIndex(index);
        return unlink(node(index));
    }
        
    public boolean remove(Object o) {
        if (o == null) {
            for (Node<E> x = first; x != null; x = x.next) {
                if (x.item == null) {
                    unlink(x);
                    return true;
                }
            }
        } else {
            for (Node<E> x = first; x != null; x = x.next) {
                if (o.equals(x.item)) {
                    unlink(x);
                    return true;
                }
            }
        }
        return false;
    }
            
   public E removeLast() {
        final Node<E> l = last;
        if (l == null)
            throw new NoSuchElementException();
        return unlinkLast(l);
    }
    
    private E unlinkFirst(Node<E> f) {
        // assert f == first && f != null;
        final E element = f.item;
        final Node<E> next = f.next;
        f.item = null;
        f.next = null; // help GC
        first = next;
        if (next == null)
            last = null;
        else
            next.prev = null;
        size--;
        modCount++;
        return element;
    }

    private E unlinkLast(Node<E> l) {
        // assert l == last && l != null;
        final E element = l.item;
        final Node<E> prev = l.prev;
        l.item = null;
        l.prev = null; // help GC
        last = prev;
        if (prev == null)
            first = null;
        else
            prev.next = null;
        size--;
        modCount++;
        return element;
    }

    E unlink(Node<E> x) {
        //æ‰¾å‡ºè¦åˆ é™¤èŠ‚ç‚¹çš„å‰é©±ä¸åç»§
        final E element = x.item;
        final Node<E> next = x.next;
        final Node<E> prev = x.prev;

        //å¦‚æœå‰é©±ä¸ºç©ºï¼Œåˆ™å°†è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§è®¾ç½®ä¸ºèµ·å§‹èŠ‚ç‚¹ï¼Œå¦åˆ™å°†åˆ é™¤èŠ‚ç‚¹çš„å‰é©±çš„åç»§æŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„åç»§
        if (prev == null) {
            first = next;
        } else {
            prev.next = next;
            x.prev = null;
        }

        //å¦‚æœåç»§ä¸ºç©ºï¼Œåˆ™ç›´æ¥å°†åˆ é™¤èŠ‚ç‚¹çš„å‰é©±ä½œä¸ºæœ«å°¾èŠ‚ç‚¹ï¼Œå¦åˆ™å°†åˆ é™¤èŠ‚ç‚¹çš„åç»§çš„å‰é©±æŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„å‰é©±
        if (next == null) {
            last = prev;
        } else {
            next.prev = prev;
            x.next = null;
        }
        //åˆ é™¤å…ƒç´ ç½®ç©ºï¼Œå¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1
        x.item = null;
        size--;
        modCount++;
        return element;
    }
}
```

å¯ä»¥çœ‹å‡ºï¼Œåˆ é™¤çš„è¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªæ¥è§¦å‰é©±å’Œåç»§çš„è¿‡ç¨‹ã€‚ä¸»è¦çš„æœ‰unlinkæ–¹æ³•æ¥å®ç°ï¼Œå…·ä½“è¯´æ¥ï¼š

unlink

1. æ‰¾å‡ºè¦åˆ é™¤èŠ‚ç‚¹çš„å‰é©±ä¸åç»§
2. å¦‚æœå‰é©±ä¸ºç©ºï¼Œåˆ™å°†è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§è®¾ç½®ä¸ºèµ·å§‹èŠ‚ç‚¹ï¼Œå¦åˆ™å°†åˆ é™¤èŠ‚ç‚¹çš„å‰é©±çš„åç»§æŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„åç»§
3. å¦‚æœåç»§ä¸ºç©ºï¼Œåˆ™ç›´æ¥å°†åˆ é™¤èŠ‚ç‚¹çš„å‰é©±ä½œä¸ºæœ«å°¾èŠ‚ç‚¹ï¼Œå¦åˆ™å°†åˆ é™¤èŠ‚ç‚¹çš„åç»§çš„å‰é©±æŒ‡å‘åˆ é™¤èŠ‚ç‚¹çš„å‰é©±
4. åˆ é™¤å…ƒç´ ç½®ç©ºï¼Œå¤§å°åŠ è‡ªå¢1ï¼Œä¿®æ”¹å­—æ•°è‡ªå¢1

è¿™ä¹ˆæè¿°æœ‰ç‚¹ç»•ï¼Œå°±æ˜¯åˆ é™¤åŸæ¥çš„å‰é©±åç»§å…³ç³»ï¼Œé‡æ–°å»ºç«‹è¿æ¥ã€‚

#### set

æ—¶é—´å¤æ‚åº¦ï¼šO(N)

å®ç°åŸç†ï¼šæŸ¥æ‰¾æŒ‡å®šindexå¯¹åº”èŠ‚ç‚¹ï¼Œæ›¿æ¢æ‰èŠ‚ç‚¹é‡Œçš„å…ƒç´ ï¼Œsetæ“ä½œä¹Ÿæœ‰ä¸ªæŸ¥æ‰¾è¿‡ç¨‹ã€‚

```java
public class LinkedList<E>
    extends AbstractSequentialList<E>
    implements List<E>, Deque<E>, Cloneable, java.io.Serializable{
    
    public E set(int index, E element) {
        checkElementIndex(index);
        Node<E> x = node(index);
        E oldVal = x.item;
        x.item = element;
        return oldVal;
    }
        
    //æŸ¥æ‰¾æŒ‡å®šç´¢å¼•çš„èŠ‚ç‚¹
    Node<E> node(int index) {
        //æ ¹æ®indexçš„å¤§å°å†³å®šæ˜¯ä»èµ·å§‹èŠ‚ç‚¹ï¼Œè¿˜æ˜¯ä»æœ«å°¾èŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾
        if (index < (size >> 1)) {
            Node<E> x = first;
            for (int i = 0; i < index; i++)
                x = x.next;
            return x;
        } else {
            Node<E> x = last;
            for (int i = size - 1; i > index; i--)
                x = x.prev;
            return x;
        }
    }
}
```
#### get

æ—¶é—´å¤æ‚åº¦ï¼šO(N)

å®ç°åŸç†ï¼šæ ¹æ®indexçš„ä½ç½®å†³å®šæ˜¯ä»èµ·å§‹èŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾ï¼Œè¿˜æ˜¯ä»æœ«å°¾èŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾ã€‚

```java
public class LinkedList<E>
    extends AbstractSequentialList<E>
    implements List<E>, Deque<E>, Cloneable, java.io.Serializable{
    
    public E get(int index) {
        checkElementIndex(index);
        return node(index).item;
    }
    
    //æŸ¥æ‰¾æŒ‡å®šç´¢å¼•çš„èŠ‚ç‚¹
    Node<E> node(int index) {
        //æ ¹æ®indexçš„å¤§å°å†³å®šæ˜¯ä»èµ·å§‹èŠ‚ç‚¹ï¼Œè¿˜æ˜¯ä»æœ«å°¾èŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾
        if (index < (size >> 1)) {
            Node<E> x = first;
            for (int i = 0; i < index; i++)
                x = x.next;
            return x;
        } else {
            Node<E> x = last;
            for (int i = size - 1; i > index; i--)
                x = x.prev;
            return x;
        }
    }
}
```