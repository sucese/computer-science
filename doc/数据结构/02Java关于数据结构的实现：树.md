# Javaå…³äºæ•°æ®ç»“æ„çš„å®ç°ï¼šæ ‘

**å…³äºä½œè€…**

>éƒ­å­æ˜Ÿï¼Œéè‘—åç¨‹åºå‘˜ï¼Œä¸»è¦ä»äº‹Androidå¹³å°åŸºç¡€æ¶æ„ä¸ä¸­é—´ä»¶æ–¹é¢çš„å·¥ä½œï¼Œæ¬¢è¿äº¤æµæŠ€æœ¯æ–¹é¢çš„é—®é¢˜ï¼Œå¯ä»¥å»æˆ‘çš„[Github](https://github.com/guoxiaoxing)æäº¤Issueæˆ–è€…å‘é‚®ä»¶è‡³guoxiaoxingse@163.comä¸æˆ‘è”ç³»ã€‚

**æ–‡ç« ç›®å½•**

- ä¸€ æ ‘çš„æ¦‚å¿µä¸åº”ç”¨åœºæ™¯
    - 1.1 äºŒå‰æŸ¥æ‰¾æ ‘
    - 1.2 AVLæ ‘
    - 1.3 çº¢é»‘æ ‘
    - 1.4 Bæ ‘
- äºŒ æ ‘çš„æ“ä½œä¸æºç å®ç°
    - 2.1 TreeMapå®ç°åŸç†
    - 2.2 TreeSetå®ç°åŸç†

## ä¸€ æ ‘çš„æ¦‚å¿µä¸åº”ç”¨åœºæ™¯

>æ ‘æ˜¯ä¸€ç§æŠ½è±¡æ•°æ®ç±»å‹ï¼ˆADTï¼‰æˆ–æ˜¯å®ä½œè¿™ç§æŠ½è±¡æ•°æ®ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥æ¨¡æ‹Ÿå…·æœ‰æ ‘çŠ¶ç»“æ„æ€§è´¨çš„æ•°æ®é›†åˆã€‚å®ƒæ˜¯ç”±nï¼ˆn>0ï¼‰ä¸ªæœ‰é™èŠ‚ç‚¹ç»„æˆä¸€ä¸ªå…·æœ‰å±‚æ¬¡å…³ç³»çš„é›†åˆã€‚æŠŠ
å®ƒå«åšâ€œæ ‘â€æ˜¯å› ä¸ºå®ƒçœ‹èµ·æ¥åƒä¸€æ£µå€’æŒ‚çš„æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯æ ¹æœä¸Šï¼Œè€Œå¶æœä¸‹çš„ã€‚

æ ‘æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- æ¯ä¸ªèŠ‚ç‚¹æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå­èŠ‚ç‚¹ï¼›
- æ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ç§°ä¸ºæ ¹èŠ‚ç‚¹ï¼›
- æ¯ä¸€ä¸ªéæ ¹èŠ‚ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼›
- é™¤äº†æ ¹èŠ‚ç‚¹å¤–ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹å¯ä»¥åˆ†ä¸ºå¤šä¸ªä¸ç›¸äº¤çš„å­æ ‘ï¼›

ä¸æ ‘ç›¸å…³çš„æ¦‚å¿µ

- èŠ‚ç‚¹çš„åº¦ï¼šä¸€ä¸ªèŠ‚ç‚¹å«æœ‰çš„å­æ ‘çš„ä¸ªæ•°ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„åº¦ï¼›
- æ ‘çš„åº¦ï¼šä¸€æ£µæ ‘ä¸­ï¼Œæœ€å¤§çš„èŠ‚ç‚¹çš„åº¦ç§°ä¸ºæ ‘çš„åº¦ï¼›
- å¶èŠ‚ç‚¹æˆ–ç»ˆç«¯èŠ‚ç‚¹ï¼šåº¦ä¸ºé›¶çš„èŠ‚ç‚¹ï¼›
- éç»ˆç«¯èŠ‚ç‚¹æˆ–åˆ†æ”¯èŠ‚ç‚¹ï¼šåº¦ä¸ä¸ºé›¶çš„èŠ‚ç‚¹ï¼›
- çˆ¶äº²èŠ‚ç‚¹æˆ–çˆ¶èŠ‚ç‚¹ï¼šè‹¥ä¸€ä¸ªèŠ‚ç‚¹å«æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™è¿™ä¸ªèŠ‚ç‚¹ç§°ä¸ºå…¶å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼›
- å­©å­èŠ‚ç‚¹æˆ–å­èŠ‚ç‚¹ï¼šä¸€ä¸ªèŠ‚ç‚¹å«æœ‰çš„å­æ ‘çš„æ ¹èŠ‚ç‚¹ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼›
- å…„å¼ŸèŠ‚ç‚¹ï¼šå…·æœ‰ç›¸åŒçˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹äº’ç§°ä¸ºå…„å¼ŸèŠ‚ç‚¹ï¼›
- èŠ‚ç‚¹çš„å±‚æ¬¡ï¼šä»æ ¹å¼€å§‹å®šä¹‰èµ·ï¼Œæ ¹ä¸ºç¬¬1å±‚ï¼Œæ ¹çš„å­èŠ‚ç‚¹ä¸ºç¬¬2å±‚ï¼Œä»¥æ­¤ç±»æ¨ï¼›
- æ·±åº¦ï¼šå¯¹äºä»»æ„èŠ‚ç‚¹n, nçš„æ·±åº¦ä¸ºä»æ ¹åˆ°nçš„å”¯ä¸€è·¯å¾„é•¿ï¼Œæ ¹çš„æ·±åº¦ä¸º0ï¼›
- é«˜åº¦ï¼šå¯¹äºä»»æ„èŠ‚ç‚¹n, nçš„é«˜åº¦ä¸ºä»nåˆ°ä¸€ç‰‡æ ‘å¶çš„æœ€é•¿è·¯å¾„é•¿ï¼Œæ‰€æœ‰æ ‘å¶çš„é«˜åº¦ä¸º0ï¼›
- å ‚å…„å¼ŸèŠ‚ç‚¹ï¼šçˆ¶èŠ‚ç‚¹åœ¨åŒä¸€å±‚çš„èŠ‚ç‚¹äº’ä¸ºå ‚å…„å¼Ÿï¼›
- èŠ‚ç‚¹çš„ç¥–å…ˆï¼šä»æ ¹åˆ°è¯¥èŠ‚ç‚¹æ‰€ç»åˆ†æ”¯ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ï¼›
- å­å­™ï¼šä»¥æŸèŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ä¸­ä»»ä¸€èŠ‚ç‚¹éƒ½ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„å­å­™ã€‚
- æ£®æ—ï¼šç”±mï¼ˆm>=0ï¼‰æ£µäº’ä¸ç›¸äº¤çš„æ ‘çš„é›†åˆç§°ä¸ºæ£®æ—ï¼›

æ³¨ï¼šå‚ç…§äº²æˆšå…³ç³»ï¼Œè¿™äº›æ¦‚å¿µå¾ˆå¥½ç†è§£ï¼Œå®¶æ—è°±ä¹Ÿæ˜¯ä¸€ç§æ ‘ç»“æ„ã€‚ğŸ˜€

æ ‘çš„åˆ†ç±»

- æ— åºæ ‘ï¼šæ ‘ä¸­ä»»æ„èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¹‹é—´æ²¡æœ‰é¡ºåºå…³ç³»ï¼Œè¿™ç§æ ‘ç§°ä¸ºæ— åºæ ‘ï¼Œä¹Ÿç§°ä¸ºè‡ªç”±æ ‘ï¼›
- æœ‰åºæ ‘ï¼šæ ‘ä¸­ä»»æ„èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¹‹é—´æœ‰é¡ºåºå…³ç³»ï¼Œè¿™ç§æ ‘ç§°ä¸ºæœ‰åºæ ‘ï¼›

å…¶ä¸­æœ‰åºæ ‘åˆåˆ†ä¸ºï¼š

- äºŒå‰æ ‘ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå«æœ‰ä¸¤ä¸ªå­æ ‘çš„æ ‘ç§°ä¸ºäºŒå‰æ ‘ï¼›
- å®Œå…¨äºŒå‰æ ‘ï¼šå¯¹äºä¸€é¢—äºŒå‰æ ‘ï¼Œå‡è®¾å…¶æ·±åº¦ä¸ºdï¼ˆd>1ï¼‰ã€‚é™¤äº†ç¬¬då±‚å¤–ï¼Œå…¶å®ƒå„å±‚çš„èŠ‚ç‚¹æ•°ç›®å‡å·²è¾¾æœ€å¤§å€¼ï¼Œä¸”ç¬¬då±‚æ‰€æœ‰èŠ‚ç‚¹ä»å·¦å‘å³è¿ç»­åœ°ç´§å¯†æ’åˆ—ï¼Œè¿™æ ·çš„äºŒå‰æ ‘è¢«ç§°ä¸ºå®Œå…¨äºŒå‰æ ‘ï¼›
- æ»¡äºŒå‰æ ‘ï¼šæ‰€æœ‰å¶èŠ‚ç‚¹éƒ½åœ¨æœ€åº•å±‚çš„å®Œå…¨äºŒå‰æ ‘ï¼›
- AVLæ ‘ï¼šå½“ä¸”ä»…å½“ä»»ä½•èŠ‚ç‚¹çš„ä¸¤æ£µå­æ ‘çš„é«˜åº¦å·®ä¸å¤§äº1çš„äºŒå‰æ ‘ï¼›
- äºŒå‰æŸ¥æ‰¾æ ‘ï¼šæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå®ƒçš„å·¦å­æ ‘ä¸­æ‰€æœ‰é¡¹å°äºXä¸­çš„é¡¹ï¼Œå®ƒçš„å³å­æ ‘ä¸­çš„æ‰€æœ‰é¡¹å¤§äºXä¸­çš„é¡¹ã€‚
- éœå¤«æ›¼æ ‘ï¼šå¸¦æƒè·¯å¾„æœ€çŸ­çš„äºŒå‰æ ‘ç§°ä¸ºå“ˆå¤«æ›¼æ ‘æˆ–æœ€ä¼˜äºŒå‰æ ‘ï¼›
- Bæ ‘ï¼šä¸€ç§å¯¹è¯»å†™æ“ä½œè¿›è¡Œä¼˜åŒ–çš„è‡ªå¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œèƒ½å¤Ÿä¿æŒæ•°æ®æœ‰åºï¼Œæ‹¥æœ‰å¤šä½™ä¸¤ä¸ªå­æ ‘ã€‚

### 1.1 äºŒå‰æŸ¥æ‰¾æ ‘

>äºŒå‰æŸ¥æ‰¾æ ‘æ˜¯ä¸€ç§æœ‰åºäºŒå‰æ ‘ï¼Œå®ƒçš„æŸ¥æ‰¾ã€æ’å…¥çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logN)

äºŒå‰æŸ¥æ‰¾æ˜¯æ˜¯ä¸€ç§æœ‰åºäºŒå‰æ ‘.

**ä¸»è¦ç‰¹ç‚¹**

- è‹¥ä»»æ„èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ã€‚
- è‹¥ä»»æ„èŠ‚ç‚¹çš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ã€‚
- ä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘å¶ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘
- æ²¡æœ‰é”®å€¼ç›¸ç­‰çš„èŠ‚ç‚¹ã€‚

å°±å°±æ˜¯è¯´äºŒå‰æŸ¥æ‰¾æ ‘ä¸Šçš„èŠ‚ç‚¹æ˜¯æ’å¥½åºçš„ï¼šå·¦å­æ ‘ < æ ¹èŠ‚ç‚¹ < å³å­æ ‘ã€‚

**æ€§èƒ½åˆ†æ**

- åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œå³å½“å…ˆåæ’å…¥çš„å…³é”®å­—æœ‰åºæ—¶ï¼Œæ„é€ æˆçš„äºŒå‰æŸ¥æ‰¾æ ‘èœ•å˜ä¸ºå•æ”¯æ ‘ï¼Œè¾“çš„æ·±åº¦ä¸ºnï¼Œå…¶å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º(n+1)/2ã€‚
- åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼ŒäºŒå‰æŸ¥æ‰¾æ ‘çš„å½¢æ€å’ŒæŠ˜åŠæŸ¥æ‰¾çš„åˆ¤å®šæ ‘ç›¸åŒï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸ºO(log2(N))ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹äºŒå‰æŸ¥æ‰¾æ ‘ä¸Šçš„ç›¸å…³æ“ä½œã€‚

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/tree/binary_search_tree.png"/>

#### æ„é€ 

å½“æˆ‘ä»¬ç”¨ä¸€ç»„æ•°å€¼æ„é€ ä¸€æ£µäºŒå‰æŸ¥æ‰¾æ ‘æ—¶ï¼Œå°±ç›¸å½“äºå¯¹è¿™ç»„æ•°å€¼è¿›è¡Œäº†æ’åºï¼Œåœ¨æœ€åæƒ…å†µä¸‹ï¼Œå³è¯¥ç»„æ•°å€¼æ˜¯ä»å°åˆ°è¾¾æ’å¥½åºçš„ï¼Œæ„é€ å‡ºæ¥çš„äºŒå‰æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½
æ²¡æœ‰å·¦å­æ ‘ï¼Œè¿™ç§æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N2)ã€‚ï¼ˆNçš„å¹³æ–¹ï¼‰

å¦å¤–ï¼Œæ ‘æ’åºçš„é—®é¢˜ä½¿å¾—CPU Cacheæ€§èƒ½è¾ƒå·®ï¼Œç‰¹åˆ«æ˜¯å½“èŠ‚ç‚¹æ˜¯åŠ¨æ€å†…å­˜åˆ†é…æ—¶ã€‚è€Œå †æ’åºçš„CPU Cacheæ€§èƒ½è¾ƒå¥½ã€‚å¦ä¸€æ–¹é¢ï¼Œæ ‘æ’åºæ˜¯æœ€ä¼˜çš„å¢é‡æ’åºï¼ˆincremental sortingï¼‰ç®—æ³•ï¼Œ
ä¿æŒä¸€ä¸ªæ•°å€¼åºåˆ—çš„æœ‰åºæ€§ã€‚

#### æŸ¥æ‰¾

ç”±äºäºŒå‰æŸ¥æ‰¾æ ‘å…·æœ‰å·¦å­æ ‘ < æ ¹èŠ‚ç‚¹ < å³å­æ ‘çš„ç‰¹ç‚¹ï¼Œå› æ­¤åœ¨äºŒå‰æŸ¥æ‰¾æ ‘bä¸­æŸ¥æ‰¾xçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™æŸ¥æ‰¾å¤±è´¥ï¼Œå¦åˆ™ï¼š
2. è‹¥xç­‰äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼Œå¦åˆ™ï¼š
3. è‹¥xå°äºbæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™æŸ¥æ‰¾å·¦å­æ ‘ï¼Œå¦åˆ™
4. è‹¥xå¤§äºbæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™æŸ¥æ‰¾å³å­æ ‘ã€‚

æ•´ä¸ªæµç¨‹æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ã€‚

#### æ’å…¥

æ’å…¥çš„è¿‡ç¨‹ä¹Ÿæ˜¯æŸ¥æ‰¾çš„è¿‡ç¨‹ï¼Œåœ¨äºŒå‰æŸ¥æ‰¾æ ‘ä¸­æ’å…¥èŠ‚ç‚¹xçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. è‹¥bæ˜¯ç©ºæ ‘ï¼Œåˆ™xä½œä¸ºæ ¹èŠ‚ç‚¹æ’å…¥ï¼Œå¦åˆ™ï¼š
2. è‹¥xçš„å€¼ç­‰äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™ï¼š
3. è‹¥xçš„å€¼å°äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼Œåˆ™å°†xæ’å…¥å½“è¯¥æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸­ï¼Œå¦åˆ™
4. å°†xæ’å…¥è¯¥æ ¹èŠ‚ç‚¹çš„å³å­æ ‘ä¸­ã€‚

è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬è¦å…³æ³¨ä¸¤ç‚¹ï¼š

- æ’å…¥çš„è¿‡ç¨‹ä¹Ÿæ˜¯æŸ¥æ‰¾çš„è¿‡ç¨‹ 
- äºŒå‰æŸ¥æ‰¾æ ‘ä¸å…è®¸æœ‰ç›¸åŒå€¼çš„èŠ‚ç‚¹

##### åˆ é™¤

åœ¨äºŒå‰æŸ¥æ‰¾æ ‘ä¸Šåˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š

1. è‹¥åˆ é™¤çš„æ˜¯å¶å­èŠ‚ç‚¹ï¼Œåˆ™ä¸ä¼šç ´åæ ‘çš„ç»“æ„ï¼Œåªéœ€è¦ä¿®æ”¹å…¶åŒäº²èŠ‚ç‚¹çš„æŒ‡é’ˆå³å¯ã€‚
2. è‹¥åˆ é™¤çš„èŠ‚ç‚¹åªæœ‰å·¦å­æ ‘æˆ–å³å­æ ‘ï¼Œä¸»è¦è®©å®ƒçš„å­æ ‘ç§°ä¸ºå…¶åŒäº²èŠ‚ç‚¹çš„å­æ ‘å³å¯ï¼Œå¦‚æ­¤ä¹Ÿä¸ä¼šç ´åæ ‘çš„ç»“æ„ã€‚
3. è‹¥åˆ é™¤çš„èŠ‚ç‚¹çš„å·¦å³å­æ ‘å‡ä¸ä¸ºç©ºï¼Œè¿™ç§æƒ…å†µå¤æ‚ä¸€ä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸çš„åšæ³•æ˜¯å®ƒçš„å³å­æ ‘ä¸­æœ€å°çš„èŠ‚ç‚¹ä»£æ›¿è¯¥èŠ‚ç‚¹å¹¶é€’å½’åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œå› ä¸ºå³å­æ ‘çš„æœ€
å°èŠ‚ç‚¹ä¸ä¼šæœ‰å·¦å„¿å­ï¼Œç¬¬äºŒæ¬¡åˆ é™¤ä¼šå®¹æ˜“äº›ã€‚å…·ä½“æµç¨‹å¯ä»¥å‚è§ä¸Šå›¾ã€‚

å¦å¤–ï¼Œå¦‚æœåˆ é™¤çš„æ¬¡æ•°ä¸å¤šï¼Œå¯ä»¥é‡‡ç”¨**æ‡’æƒ°åˆ é™¤**çš„æ–¹å¼ï¼Œå³å½“ä¸€ä¸ªå…ƒç´ åˆ é™¤æ—¶ï¼Œå®ƒä»ç„¶ç•™åœ¨æ ‘ä¸­ï¼Œåªæ˜¯è¢«æ¯”è¾ƒä¸ºå·²åˆ é™¤ï¼Œè¿™ç§æ–¹å¼åœ¨æœ‰é‡å¤é¡¹æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼Œ
å¦å¤–å¦‚æœåˆ é™¤çš„å…ƒç´ åˆé‡æ–°æ’å…¥ï¼Œè¿™ç§æ–¹å¼å¯ä»¥é¿å…æ–°å•å…ƒçš„åˆ›å»ºå¼€é”€ã€‚

### 1.2 AVLæ ‘

>AVLæ ‘æ˜¯å¸¦æœ‰å¹³è¡¡æ¡ä»¶çš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚

**ä¸»è¦ç‰¹ç‚¹**

- AVLæ ‘ä¸­çš„ä»»ä½•é˜¶æ®µçš„ä¸¤æ£µå­æ ‘é«˜åº¦æœ€å¤§å·®åˆ«ä¸º1.

AVLæ ‘è¿˜æœ‰ä¸ªå¹³è¡¡å› å­çš„æ¦‚å¿µï¼Œå¹³è¡¡å› å­ = å·¦å­æ ‘é«˜åº¦ - å³å­æ ‘é«˜åº¦ï¼Œå› æ­¤å¹³è¡¡å› å­ä¸º-1ï¼Œ0ï¼Œ1çš„ä¸ºå¹³è¡¡äºŒå‰æ ‘ï¼Œå…¶ä»–çš„éƒ½æ˜¯ä¸å¹³è¡¡çš„ã€‚

å¦å¤–ï¼ŒæŠŠä¸€æ£µä¸å¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘å˜æˆä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**AVLæ—‹è½¬**ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹ä¸åŒæƒ…å†µä¸‹AVLæ—‹è½¬å¦‚ä½•è¿›è¡Œã€‚

- å·¦å·¦æƒ…å†µï¼šå³æ—‹
- å³å³æƒ…å†µï¼šå·¦æ—‹
- å·¦å³æƒ…å†µï¼šå…ˆå·¦æ—‹ï¼Œå†å³æ—‹
- å³å·¦æƒ…å†µï¼šå…ˆå³æ—‹ï¼Œå†å·¦æ—‹

æ³¨ï¼šæ‰€è°“å·¦å·¦æŒ‡çš„æ˜¯å·¦è¾¹çš„å·¦å­æ ‘å¤šäº†ä¸€ä¸ªï¼Œå…¶ä»–çš„ä¾æ­¤ç±»æ¨ã€‚

å…·ä½“æ“ä½œå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å·¦å·¦æƒ…å†µå’Œå³å³æƒ…å†µåªéœ€è¦å•æ—‹è½¬å°±å¯ä»¥å®Œæˆï¼Œå·¦å³æƒ…å†µä¸å³å·¦æƒ…å†µéœ€è¦å…ˆæŠŠå®ƒä»¬å˜æˆå·¦å·¦æƒ…å†µä¸å³å³æƒ…å†µ
å†è¿›è¡Œæ—‹è½¬ï¼Œå› æ­¤è¿™ä¸¤ç§æƒ…å†µéœ€è¦åŒæ—‹è½¬æ‰èƒ½å®Œæˆã€‚

<img src="https://github.com/guoxiaoxing/data-structure-and-algorithm/raw/master/art/tree/avl_tree.png"/>

**æ€§èƒ½åˆ†æ**

æŸ¥æ‰¾ã€æ’å…¥ä¸åˆ é™¤åœ¨å¹³å‡å’Œæœ€åçš„æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logN)ã€‚

AVLæ ‘ä¹Ÿæ˜¯äºŒå‰æŸ¥æ‰¾æ ‘çš„ä¸€ç§ï¼Œå®ƒçš„å¾ˆå¤šæ“ä½œéƒ½å¯ä»¥å‘æˆ‘ä»¬ä¸Šé¢æè¿°çš„äºŒå‰æŸ¥æ‰¾æ ‘çš„æ“ä½œé‚£æ ·è¿›è¡Œã€‚åˆ é™¤æ“ä½œæœ‰ç‚¹ä¾‹å¤–ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œåˆ é™¤æ“ä½œ
æ—¶å¯ä»¥æŠŠè¦åˆ é™¤çš„èŠ‚ç‚¹å‘ä¸‹æ—‹è½¬å½¢æˆä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œç„¶åç›´æ¥åˆ é™¤è¿™ä¸ªå¶å­èŠ‚ç‚¹ï¼Œå› ä¸ºæ—‹è½¬æˆå¶å­èŠ‚ç‚¹æœŸé—´ï¼Œåšå¤šæœ‰logNä¸ªèŠ‚ç‚¹è¢«æ—‹è½¬ï¼Œæ¯æ¬¡
AVLæ—‹è½¬èŠ±è´¹çš„äº‹ä»¶å›ºå®šï¼Œæ‰€ä»¥åˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(logN)ã€‚

### 1.3 çº¢é»‘æ ‘

>çº¢é»‘æ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘çš„å˜ç§ï¼Œå®ƒçš„æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(logN).

çº¢é»‘æ ‘æ˜¯ä¸€ç§å…·æœ‰ç€è‰²æ€§è´¨çš„æ ‘ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- æ¯ä¸ªèŠ‚ç‚¹è¢«ç€æˆçº¢è‰²æˆ–è€…é»‘è‰²
- æ ¹æ˜¯é»‘è‰²çš„
- å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œé‚£ä¹ˆä»–é¢å­èŠ‚ç‚¹å¿…é¡»æ˜¯é»‘è‰²çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå­˜åœ¨ä¸¤ä¸ªçº¢è‰²èŠ‚ç‚¹æ¯—é‚»ï¼Œä¸€æ¡è·¯å¾„ä¸Šæ€»æ˜¯çº¢é»‘èŠ‚ç‚¹äº¤æ›¿å‡ºç°ã€‚
- ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°ä¸€ä¸ªnullå¼•ç”¨çš„æ¯ä¸€æ¡è·¯å¾„å¿…é¡»åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚

çº¢é»‘æ ‘ä¹Ÿæ˜¯ä¸€ç§äºŒå‰æŸ¥æ‰¾æ ‘ï¼ŒæŸ¥æ‰¾æ“ä½œä¸äºŒå‰æŸ¥æ‰¾æ ‘ç›¸åŒï¼Œæ’å…¥ä¸åˆ é™¤æ“ä½œæœ‰æ‰€ä¸åŒã€‚

#### æ’å…¥



#### åˆ é™¤

### 1.4 Bæ ‘

>Bæ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„æ ‘ï¼Œèƒ½å¤Ÿä¿æŒæ•°æ®æœ‰åºï¼ŒBæ ‘ä¸ºç³»ç»Ÿå¤§å—æ•°æ®çš„è¯»å†™æ“ä½œåšäº†ä¼˜åŒ–ï¼Œé€šå¸¸ç”¨åœ¨æ•°æ®åº“ä¸æ–‡ä»¶ç³»ç»Ÿçš„å®ç°ä¸Šã€‚

æˆ‘ä»¬å‰é¢è®²è§£äº†äºŒå‰æŸ¥æ‰¾æ ‘ã€AVLæ ‘ï¼Œçº¢é»‘æ ‘ï¼Œè¿™ä¸‰ç§éƒ½æ˜¯å…¸å‹çš„äºŒå‰æŸ¥æ‰¾æ ‘ç»“æ„ï¼Œå…¶æŸ¥æ‰¾çš„äº‹ä»¶å¤æ‚åº¦O(logN)ä¸æ ‘çš„æ·±åº¦æœ‰å…³ï¼Œè€ƒè™‘è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œå¦‚æœæœ‰
å¤§é‡çš„æ•°æ®ï¼Œè€ŒèŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®æœ‰é™ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªèƒ½å»æ‰©å……æ ‘çš„æ·±åº¦ï¼Œå°±ä¼šå¯¼è‡´æŸ¥æ‰¾æ•ˆç‡ä½ä¸‹ã€‚

æ€ä¹ˆè§£å†³è¿™ç§é—®é¢˜ï¼Œä¸€ä¸ªç®€å•çš„æƒ³æ³•å°±æ˜¯ï¼šäºŒå‰å˜å¤šå‰ã€‚

è¿™é‡Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§æ ‘ç»“æ„ï¼Œåœ¨æŸ¥æ‰¾æ–‡ä»¶æ—¶ï¼Œæ ‘çš„æ·±åº¦å°±å†³å®šäº†æŸ¥æ‰¾çš„æ•ˆç‡ã€‚å› æ­¤Bæ ‘å°±æ˜¯ä¸ºäº†å‡å°‘æ•°çš„æ·±åº¦ä»è€Œæé«˜æŸ¥æ‰¾æ•ˆç‡çš„ä¸€ç§
æ•°æ®ç»“æ„ã€‚

**ä¸»è¦ç‰¹ç‚¹**

ä¸€ä¸ªé˜¶ä¸ºMçš„Bæ ‘å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

æ³¨ï¼šMé˜¶æŒ‡çš„æ˜¯Må‰æŸ¥æ‰¾æ ‘ï¼Œä¾‹å¦‚M = 2ï¼Œåˆ™ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘ã€‚

- æ•°æ®é¡¹å­˜å‚¨åœ¨æ ‘å¶ä¸Š
- éå¶èŠ‚ç‚¹å­˜å‚¨ç›´åˆ°M-1ä¸ªå…³é”®å­—ä»¥æŒ‡ç¤ºæœç´¢æ–¹å‘ï¼šå…³é”®å­—ä»£è¡¨å­æ ‘i+1ä¸­æœ€å°çš„å…³é”®å­—
- æ ‘çš„æ ¹æˆ–è€…æ˜¯ä¸€ç‰‡æ ‘å¶ï¼Œæˆ–è€…å…¶å„¿å­æ•°éƒ½åœ¨2å’ŒMä¹‹é—´ã€‚
- é™¤æ ¹å¤–ï¼Œæ‰€æœ‰éæ ‘å¶èŠ‚ç‚¹çš„å„¿å­æ ‘åœ¨M/2ä¸Mä¹‹é—´ã€‚
- æ‰€æœ‰çš„æ ‘å¶éƒ½åœ¨ç›¸åŒçš„æ·±åº¦ä¸Šæ‹¥æœ‰çš„æ•°æ®é¡¹éƒ½åœ¨L/2ä¸Lä¹‹é—´ã€‚

**æ€§èƒ½åˆ†æ**

Bæ ‘åœ¨æŸ¥æ‰¾ã€æ’å…¥ä»¥åŠåˆ é™¤ç­‰æ“ä½œä¸­ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logN)ã€‚

## äºŒ æ ‘çš„æ“ä½œä¸æºç å®ç°

åœ¨æ–‡ç« [01Javaå…³äºæ•°æ®ç»“æ„çš„å®ç°ï¼šè¡¨ã€æ ˆä¸é˜Ÿåˆ—](https://github.com/guoxiaoxing/data-structure-and-algorithm/blob/master/doc/æ•°æ®ç»“æ„/01Javaå…³äºæ•°æ®ç»“æ„çš„å®ç°ï¼šè¡¨ã€æ ˆä¸é˜Ÿåˆ—.md)ä¸­æˆ‘ä»¬
è®¨è®ºäº†ArrayListä¸LinkedListçš„å®ç°ï¼Œå®ƒä»¬çš„ç“¶é¢ˆåœ¨äºæŸ¥æ‰¾æ•ˆç‡ä½ä¸‹ã€‚å› è€ŒJavaé›†åˆè®¾è®¡äº†Setä¸Mapæ¥å£ï¼Œå®ƒä»¬åœ¨æ’å…¥ã€åˆ é™¤ä¸æŸ¥æ‰¾ç­‰åŸºæœ¬æ“ä½œéƒ½æœ‰è‰¯å¥½çš„è¡¨ç°ã€‚

### 2.1 TreeMapå®ç°åŸç†

>TreeMapæ˜¯ä¸€ä¸ªåŸºäºçº¢é»‘æ ‘å®ç°çš„é›†åˆï¼Œå®ƒå¯ä»¥å¯¹é‡Œé¢çš„å…ƒç´ è¿›è¡Œæ’åºã€‚

ç±»çš„æˆå‘˜å˜é‡

```java
//æ¯”è¾ƒå™¨
private final Comparator<? super K> comparator;
//æ ¹èŠ‚ç‚¹
private transient TreeMapEntry<K,V> root = null;
//é›†åˆå¤§å°
private transient int size = 0;
//ä¿®æ”¹æ¬¡æ•°
private transient int modCount = 0;
```

ç±»çš„æ„é€ æ–¹æ³•

```java
public TreeMap() {
    //é»˜è®¤æ¯”è¾ƒå™¨
    comparator = null;
}

public TreeMap(Comparator<? super K> comparator) {
    //æŒ‡å®šæ¯”è¾ƒå™¨
    this.comparator = comparator;
}


public TreeMap(Map<? extends K, ? extends V> m) {
    //é»˜è®¤æ¯”è¾ƒå™¨
    comparator = null;
    putAll(m);
}

public TreeMap(SortedMap<K, ? extends V> m) {
    //æŒ‡å®šæ¯”è¾ƒå™¨
    comparator = m.comparator();
    try {
        buildFromSorted(m.size(), m.entrySet().iterator(), null, null);
    } catch (java.io.IOException cannotHappen) {
    } catch (ClassNotFoundException cannotHappen) {
    }
}
```

TreeMapé‡Œé¢å®šä¹‰äº†é™æ€å†…éƒ¨ç±»TreeMapEntryæ¥æè¿°èŠ‚ç‚¹ä¿¡æ¯ã€‚

```java
   static final class TreeMapEntry<K,V> implements Map.Entry<K,V> {
        //é”®
        K key;
        //å€¼
        V value;
        //æŒ‡å‘å·¦å­æ ‘çš„å¼•ç”¨
        TreeMapEntry<K,V> left = null;
        //æŒ‡å‘å³å­æ ‘çš„å¼•ç”¨
        TreeMapEntry<K,V> right = null;
        //æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„å¼•ç”¨
        TreeMapEntry<K,V> parent;
        //èŠ‚ç‚¹é¢œè‰²ï¼Œé»˜è®¤ä¸ºé»‘è‰²
        boolean color = BLACK;

        /**
         * Make a new cell with given key, value, and parent, and with
         * {@code null} child links, and BLACK color.
         */
        TreeMapEntry(K key, V value, TreeMapEntry<K,V> parent) {
            this.key = key;
            this.value = value;
            this.parent = parent;
        }

        /**
         * Returns the key.
         *
         * @return the key
         */
        public K getKey() {
            return key;
        }

        /**
         * Returns the value associated with the key.
         *
         * @return the value associated with the key
         */
        public V getValue() {
            return value;
        }

        /**
         * Replaces the value currently associated with the key with the given
         * value.
         *
         * @return the value associated with the key before this method was
         *         called
         */
        public V setValue(V value) {
            V oldValue = this.value;
            this.value = value;
            return oldValue;
        }

        public boolean equals(Object o) {
            if (!(o instanceof Map.Entry))
                return false;
            Map.Entry<?,?> e = (Map.Entry<?,?>)o;

            return valEquals(key,e.getKey()) && valEquals(value,e.getValue());
        }

        public int hashCode() {
            int keyHash = (key==null ? 0 : key.hashCode());
            int valueHash = (value==null ? 0 : value.hashCode());
            return keyHash ^ valueHash;
        }

        public String toString() {
            return key + "=" + value;
        }
    }
```

åœ¨æ­£å¼ä»‹ç»TreeMapé‡Œçš„å¢ã€åˆ ã€æ”¹ã€æŸ¥æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹TreeMopé‡Œå…³äºèŠ‚ç‚¹æŸ“è‰²ï¼Œæ ‘çš„æ—‹è½¬ç­‰æ“ä½œçš„å®ç°ï¼Œå®ƒä»¬æ˜¯TreeMapå®ç°çš„åŸºç¡€ã€‚

**èŠ‚ç‚¹æŸ“è‰²**

```java
public class TreeMap<K,V>
    extends AbstractMap<K,V>
    implements NavigableMap<K,V>, Cloneable, java.io.Serializable{
    
      //æŸ“è‰²
      private void fixAfterInsertion(TreeMapEntry<K,V> x) {
            x.color = RED;
    
            while (x != null && x != root && x.parent.color == RED) {
                
                //å¦‚æœxèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç­‰äº
                if (parentOf(x) == leftOf(parentOf(parentOf(x)))) {
                    TreeMapEntry<K,V> y = rightOf(parentOf(parentOf(x)));
                    if (colorOf(y) == RED) {
                        setColor(parentOf(x), BLACK);
                        setColor(y, BLACK);
                        setColor(parentOf(parentOf(x)), RED);
                        x = parentOf(parentOf(x));
                    } else {
                        if (x == rightOf(parentOf(x))) {
                            x = parentOf(x);
                            rotateLeft(x);
                        }
                        setColor(parentOf(x), BLACK);
                        setColor(parentOf(parentOf(x)), RED);
                        rotateRight(parentOf(parentOf(x)));
                    }
                } else {
                    TreeMapEntry<K,V> y = leftOf(parentOf(parentOf(x)));
                    if (colorOf(y) == RED) {
                        setColor(parentOf(x), BLACK);
                        setColor(y, BLACK);
                        setColor(parentOf(parentOf(x)), RED);
                        x = parentOf(parentOf(x));
                    } else {
                        if (x == leftOf(parentOf(x))) {
                            x = parentOf(x);
                            rotateRight(x);
                        }
                        setColor(parentOf(x), BLACK);
                        setColor(parentOf(parentOf(x)), RED);
                        rotateLeft(parentOf(parentOf(x)));
                    }
                }
            }
            root.color = BLACK;
        }
}
```

å…³äºèŠ‚ç‚¹æŸ“è‰²ï¼Œæˆ‘ä»¬æœ‰å¤šç§æƒ…å†µéœ€è¦è€ƒè™‘ã€‚

1. è‹¥æ–°èŠ‚ç‚¹ä½äºæ ‘çš„æ ¹ä¸Šï¼Œæ²¡æœ‰çˆ¶èŠ‚ç‚¹ï¼Œç›´æ¥å°†å…¶æŸ“æˆé»‘è‰²å³å¯ã€‚è¿™ä¸ªåœ¨ä»£ç ä¸­æ— éœ€æ“ä½œï¼Œå› ä¸ºèŠ‚ç‚¹é»˜è®¤å°±æ˜¯é»‘è‰²çš„ã€‚
2. è‹¥æ–°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯é»‘è‰²ï¼Œè¿™ä¸ªæ—¶å€™æ ‘ä¾ç„¶æ»¡è¶³çº¢é»‘æ ‘çš„æ€§è´¨ï¼Œå¹¶ä¸éœ€è¦é¢å¤–çš„å¤„ç†ã€‚
3. å¦‚æœæ–°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼Œä¸”å…¶å”çˆ¶èŠ‚ç‚¹ä¹Ÿä¸ºçº¢è‰²
4. å¦‚æœæ–°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼Œä¸”å…¶å”çˆ¶èŠ‚ç‚¹ä¸ºé»‘è‰²æˆ–è€…æ²¡æœ‰å”çˆ¶èŠ‚ç‚¹
5. å¦‚æœæ–°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼Œ

**æ ‘çš„æ—‹è½¬**

```java
public class TreeMap<K,V>
    extends AbstractMap<K,V>
    implements NavigableMap<K,V>, Cloneable, java.io.Serializable{
    
    //å·¦æ—‹
    private void rotateLeft(TreeMapEntry<K,V> p) {
        if (p != null) {
            TreeMapEntry<K,V> r = p.right;
            p.right = r.left;
            if (r.left != null)
                r.left.parent = p;
            r.parent = p.parent;
            if (p.parent == null)
                root = r;
            else if (p.parent.left == p)
                p.parent.left = r;
            else
                p.parent.right = r;
            r.left = p;
            p.parent = r;
        }
    }

    //å³æ—‹
    private void rotateRight(TreeMapEntry<K,V> p) {
        if (p != null) {
            TreeMapEntry<K,V> l = p.left;
            p.left = l.right;
            if (l.right != null) l.right.parent = p;
            l.parent = p.parent;
            if (p.parent == null)
                root = l;
            else if (p.parent.right == p)
                p.parent.right = l;
            else p.parent.left = l;
            l.right = p;
            p.parent = l;
        }
    }
}
```
#### put

```java
public class TreeMap<K,V>
    extends AbstractMap<K,V>
    implements NavigableMap<K,V>, Cloneable, java.io.Serializable{
    
    public V put(K key, V value) {
            //æ‰¾åˆ°æ ¹èŠ‚ç‚¹
            TreeMapEntry<K,V> t = root;
            //å¦‚æœæ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™è®¾ç½®è¯¥å…ƒç´ ä¸º
            if (t == null) {
                if (comparator != null) {
                    if (key == null) {
                        comparator.compare(key, key);
                    }
                } else {
                    if (key == null) {
                        throw new NullPointerException("key == null");
                    } else if (!(key instanceof Comparable)) {
                        throw new ClassCastException(
                                "Cannot cast" + key.getClass().getName() + " to Comparable.");
                    }
                }
    
                root = new TreeMapEntry<>(key, value, null);
                //é›†åˆå¤§å°ä¸º1
                size = 1;
                //ä¿®æ”¹æ¬¡æ•°è‡ªå¢
                modCount++;
                return null;
            }
            int cmp;
            TreeMapEntry<K,V> parent;
            //è·å–æ¯”è¾ƒå™¨
            Comparator<? super K> cpr = comparator;
            //å¦‚æœæ¯”è¾ƒå™¨ä¸ç©ºï¼Œåˆ™ç”¨æŒ‡å®šçš„æ¯”è¾ƒå™¨è¿›è¡Œæ¯”è¾ƒ
            if (cpr != null) {
                //å¾ªç¯é€’å½’ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾æ’å…¥çš„ä½ç½®ï¼Œå³æŸ¥æ‰¾çš„å®ƒçš„çˆ¶èŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾æ–¹å¼å’Œæˆ‘ä»¬ä¸Šé¢è®²çš„äºŒå‰æ’åºæ ‘çš„æŸ¥æ‰¾æ–¹å¼ç›¸åŒ
                do {
                    parent = t;
                    cmp = cpr.compare(key, t.key);
                    //æ’å…¥å€¼å°äºå½“å‰èŠ‚ç‚¹ï¼Œåˆ™ç»§ç»­åœ¨å·¦å­æ ‘ä¸ŠæŸ¥è¯¢
                    if (cmp < 0)
                        t = t.left;
                    //æ’å…¥å€¼å¤§äºå½“å‰èŠ‚ç‚¹ï¼Œåˆ™ç»§ç»­åœ¨å³å­æ ‘ä¸ŠæŸ¥è¯¢
                    else if (cmp > 0)
                        t = t.right;
                    //å¦‚æœç›¸ç­‰ï¼Œåˆ™æ›¿æ¢å½“å‰çš„å€¼
                    else
                        return t.setValue(value);
                } while (t != null);
            }
            //å¦‚æœæ¯”è¾ƒå™¨ä¸ºå¤å®å®«ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„æ¯”è¾ƒå™¨
            else {
                if (key == null)
                    throw new NullPointerException();
                @SuppressWarnings("unchecked")
                    Comparable<? super K> k = (Comparable<? super K>) key;
                do {
                    parent = t;
                    cmp = k.compareTo(t.key);
                    if (cmp < 0)
                        t = t.left;
                    else if (cmp > 0)
                        t = t.right;
                    else
                        return t.setValue(value);
                } while (t != null);
            }
            //æ ¹æ®æŸ¥æ‰¾åˆ°çš„çˆ¶èŠ‚ç‚¹ï¼Œæ„é€ èŠ‚ç‚¹ï¼Œå¹¶æ ¹æ®æ¯”ç»“æœå°†å…¶æ’å…¥åˆ°å¯¹åº”çš„ä½ç½®
            TreeMapEntry<K,V> e = new TreeMapEntry<>(key, value, parent);
            if (cmp < 0)
                parent.left = e;
            else
                parent.right = e;
            //ç»™æ’å…¥çš„èŠ‚ç‚¹æŸ“è‰²
            fixAfterInsertion(e);
            size++;
            modCount++;
            return null;
        }
}
```

æ’å…¥æ“ä½œé‡‡ç”¨äº†äºŒå‰æ’åºæ ‘çš„æŸ¥æ‰¾ç®—æ³•ï¼Œæ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š

1. å¦‚æœå½“å‰TreeMapæ²¡æœ‰æ ¹èŠ‚ç‚¹ï¼Œå°†å½“å‰èŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹æ’å…¥ï¼Œå¦åˆ™ï¼Œ
2. æ ¹æ®æä¾›çš„æ¯”è¾ƒå™¨ï¼ˆå¦‚æœæ²¡æœ‰æä¾›åˆ™ä½¿ç”¨é»˜è®¤çš„æ¯”è¾ƒå™¨ï¼‰è¿›è¡ŒæŸ¥æ‰¾æ¯”è¾ƒï¼ŒæŸ¥æ‰¾è¯¥èŠ‚ç‚¹çš„æ’å…¥ä½ç½®ï¼Œå³å®ƒçš„çˆ¶èŠ‚ç‚¹çš„ä½ç½®ã€‚
3. æŸ¥æ‰¾åˆ°çˆ¶èŠ‚ç‚¹åï¼Œæ ¹æ®æ¯”è¾ƒç»“æœæ’å…¥åˆ°å¯¹åº”ä½ç½®ï¼Œå¹¶è¿›è¡ŒæŸ“è‰²å¤„ç†ã€‚

#### put

```java
public class TreeMap<K,V>
    extends AbstractMap<K,V>
    implements NavigableMap<K,V>, Cloneable, java.io.Serializable{
    
}
```

#### put

```java
public class TreeMap<K,V>
    extends AbstractMap<K,V>
    implements NavigableMap<K,V>, Cloneable, java.io.Serializable{
    
}
```

#### put

```java
public class TreeMap<K,V>
    extends AbstractMap<K,V>
    implements NavigableMap<K,V>, Cloneable, java.io.Serializable{
    
}
```

### 2.2 TreeSetå®ç°åŸç†



